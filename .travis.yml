# https://docs.travis-ci.com/user/languages/javascript-with-nodejs/
language: node_js
dist: xenial
node_js:
  - 10
  - 8

# allow headful tests
# https://github.com/GoogleChrome/puppeteer/blob/v1.11.0/docs/troubleshooting.md#running-puppeteer-on-travis-ci
before_install:
  # Enable user namespace cloning
  - "sysctl kernel.unprivileged_userns_clone=1"

before_script:
  - sh test/server-start.sh &
  - SERVER_PID=$!
  - sleep 1
after_script:
  - kill $SERVER_PID
script: "npm test && npm run-script lint"
cache:
  directories:
    - node_modules
